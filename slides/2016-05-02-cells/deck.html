<!DOCTYPE html><html lang="en"><head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<title>ops-class.org | Cells: A Virtual Mobile Smartphone Architecture</title>
		<meta content="Geoffrey Challen" name="author">
		<meta name="description" lang="en-us" content="Discussion of Cells: A Virtual Mobile Smartphone Architecture by Jeremy Andrus et al.">

		<link href="/css/slides.css" rel="stylesheet">
		
		<link rel="apple-touch-icon" sizes="57x57" href="/img/favicon/apple-icon-57x57.png">
		<link rel="apple-touch-icon" sizes="60x60" href="/img/favicon/apple-icon-60x60.png">
		<link rel="apple-touch-icon" sizes="72x72" href="/img/favicon/apple-icon-72x72.png">
		<link rel="apple-touch-icon" sizes="76x76" href="/img/favicon/apple-icon-76x76.png">
		<link rel="apple-touch-icon" sizes="114x114" href="/img/favicon/apple-icon-114x114.png">
		<link rel="apple-touch-icon" sizes="120x120" href="/img/favicon/apple-icon-120x120.png">
		<link rel="apple-touch-icon" sizes="144x144" href="/img/favicon/apple-icon-144x144.png">
		<link rel="apple-touch-icon" sizes="152x152" href="/img/favicon/apple-icon-152x152.png">
		<link rel="apple-touch-icon" sizes="180x180" href="/img/favicon/apple-icon-180x180.png">
		<link rel="icon" type="image/png" sizes="192x192" href="/img/favicon/android-icon-192x192.png">
		<link rel="icon" type="image/png" sizes="32x32" href="/img/favicon/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="96x96" href="/img/favicon/favicon-96x96.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/img/favicon/favicon-16x16.png">
		<meta name="msapplication-TileColor" content="#ffffff">
		<meta name="msapplication-TileImage" content="/img/favicon/ms-icon-144x144.png">
		<meta name="theme-color" content="#ffffff">

		<!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
			<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->
		
		<script src="/js/slides.js" async></script>
	</head>

	<body>
		<div id="content">
			<div class="deck-container">
				<div class="nooutline spelling_exception slide" id="_technical_women">
<h2>Technical Women</h2>

<div class="imageblock hascaption">
<div class="content">
<a class="image" href="https://en.wikipedia.org/wiki/Katherine_Johnson" target="_blank"><img src="/img/slides/women/012.jpg" alt="012" style="width: 100%;"></a>
</div>
<div class="title">Figure 1. Katherine Johnson</div>
</div>
<div class="paragraph h4 center">
<p><span class="fa fa-music"></span> <a href="http://www.ofmonstersandmen.com/" target="_blank" class="external">Black Water by Of Monsters and Men</a></p>
</div>
<div class="paragraph h4 center">
<p><span class="fa fa-music"></span> <a href="https://www.facebook.com/xcoastriviera/" target="_blank" class="external">Mango Bay by X-Coast</a></p>
</div>
<div class="videoblock">

<iframe width="0" height="0" src="//www.youtube.com/embed/AILsB9G8qEw?rel=0&amp;enablejsapi=1" allowfullscreen id="_iframe_0"></iframe>

<div class="anim-play slide" data-what="iframe#_iframe_0"></div><div class="anim-pause slide" data-what="iframe#_iframe_0"></div></div>
<div class="videoblock">

<iframe width="0" height="0" src="//www.youtube.com/embed/yuyV6G6atoQ?rel=0&amp;enablejsapi=1" allowfullscreen id="_iframe_1"></iframe>

<div class="anim-play slide" data-what="iframe#_iframe_1"></div><div class="anim-pause slide" data-what="iframe#_iframe_1"></div></div>

</div>
<div class="spelling_exception slide" id="_cells_a_virtual_mobile_smartphone_architecture">
<h2>Cells: A Virtual Mobile Smartphone Architecture</h2>

<div class="paragraph">
<p><a href="http://systems.cs.columbia.edu/files/wpid-cells-sosp2011.pdf" target="_blank" class="external">&quot;Cells: A
Virtual Mobile Smartphone Architecture&quot; (PDF)</a>, by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Jeremy Andrus</p>
</li>
<li>
<p>Christoffer Dall</p>
</li>
<li>
<p>Alexander Van&#x2019;t Hof</p>
</li>
<li>
<p>Oren Laadan</p>
</li>
<li>
<p>Jason Nieh</p>
</li>
</ul>
</div>

</div>
<div class="nooutline slide" id="_cat_announce_txt">
<h2>$ cat announce.txt</h2>

<div class="ulist">
<ul>
<li class="slide">
<p>Course evaluation is currently&#x2026;&#x200B; <span class="slide"><strong>54%</strong>.</span></p>
</li>
<li class="slide">
<p>Please do the evaluation! Time is really running out&#x2026;&#x200B;</p>
</li>
<li class="slide">
<p>No class Wednesday&#x2014;&#x200B;go see the talk by Bob Horowitz</p>
</li>
<li class="slide">
<p>No recitation Friday at 8AM. (Nobody showed up last week.)</p>
</li>
</ul>
</div>

</div>
<div class="slide" id="_paper_overview">
<h2>Paper Overview</h2>

<div class="ulist">
<div class="title slide">What kind of paper is this?</div>
<ul>
<li class="slide">
<p>Old idea meets new application paper (another new type)</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title slide">What&#x2019;s the old idea?</div>
<ul>
<li class="slide">
<p>OS virtualization (aka Docker)</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title slide">What&#x2019;s the new application?</div>
<ul>
<li class="slide">
<p>Smartphones!</p>
</li>
</ul>
</div>

</div>
<div class="slide" id="_whats_a_virtual_phone">
<h2>What&#x2019;s A Virtual Phone?</h2>

<div class="quoteblock small">
<blockquote>
<div class="paragraph">
<p>Cells runs multiple VPs on a single hardware phone. Each VP runs a standard
Android environment capable of making phone calls, running unmodified Android
applications, using data connections, interacting through the touch screen,
utilizing the accelerometer, and everything else that a user can normally do
on the hardware. Each VP is completely isolated from other VPs and cannot
inspect, tamper with, or otherwise access any other VP.</p>
</div>
</blockquote>
</div>
<div style="page-break-after: always;"></div>
<div class="paragraph">
<p><span class="image"><img src="/img/slides/figures/cells-architecture.jpg" alt="cells architecture" style="width: 60%;"></span></p>
</div>

</div>
<div class="slide" id="_why_do_this">
<h2>Why Do This?</h2>

<div class="ulist">
<ul>
<li class="slide">
<p><strong>Security</strong>: apps running in one virtual phone have no visibility into
virtual phones&#x2014;&#x200B;useful for &quot;bring your own device&quot; work environments.</p>
</li>
<li class="slide">
<p><strong>Encapsulation</strong>: can distribute an entire virtual phone image preloaded
with a bunch of useful software&#x2014;&#x200B;again, think of a corporate setting.</p>
</li>
</ul>
</div>

</div>
<div class="slide" id="_why_not_use_existing_virtualization_approaches">
<h2>Why Not Use Existing Virtualization Approaches?</h2>

<div class="quoteblock small">
<blockquote>
<div class="paragraph">
<p>While VMs are useful for desktop and server computers, applying these
hardware virtualization techniques to smartphones has two crucial drawbacks.
First, smartphones are more resource constrained, and running an entire
additional operating system (OS) and user space environment in a VM imposes
high overhead and limits the number of instances that can run. Slow system
responsiveness is less acceptable on a smartphone than on a desktop computer
since smartphones are often used for just a few minutes or even seconds at a
time.</p>
</div>
</blockquote>
</div>
<div style="page-break-after: always;"></div>
<div class="quoteblock small">
<blockquote>
<div class="paragraph">
<p>Second, smartphones incorporate a plethora of devices that applications
expect to be able to use, such as GPS, cameras, and GPUs. Existing approaches
provide no effective mechanism to enable applications to directly leverage
these hardware device features from within VMs, severely limiting the overall
system performance and making existing approaches unusable on a smartphone.</p>
</div>
</blockquote>
</div>

</div>
<div class="slide" id="_what_does_container_virtualization_virtualize">
<h2>What Does Container Virtualization Virtualize?</h2>

<div class="ulist">
<ul>
<li class="slide">
<p>For hardware virtualization we virtualize the <em>hardware interface</em>: certain
instructions change the state of the VM rather than the hardware itself.</p>
</li>
<li class="slide">
<p>For container virtualization the OS interface is shared by all virtual
&quot;machines&quot; (or phones).</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title slide">So what is virtualized?</div>
<ul>
<li class="slide">
<p><em>The OS name space</em>.</p>
</li>
</ul>
</div>

</div>
<div class="slide" id="_mi_homefoo_no_es_su_homefoo">
<h2><span class="spelling_exception">Mi <code>/home/foo</code> No Es Su <code>/home/foo</code></span></h2>

<div class="paragraph">
<p>Name space virtualization requires that we isolate several name spaces between
VPs:</p>
</div>
<div class="ulist">
<ul>
<li class="slide">
<p>The file system name space: all virtual phones must see their own root
partition containing no files owned by other virtual phones.</p>
</li>
<li class="slide">
<p>The process name space: all virtual phones must see only processes running
in their own name space and not others.</p>
</li>
<li class="slide">
<p>The network name space: IP addresses, port mappings, etc.</p>
</li>
<li class="slide">
<p>The device name space (similar to the file system name space): all virtual
phones must have access to the same underlying devices through the <code>/dev/</code>
name space.</p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
<div class="quoteblock small spelling_exception">
<blockquote>
<div class="paragraph">
<p>Cells uses four techniques to isolate all VPs from the root namespace and
from one another, thereby securing both system and individual VP data from
malicious reads or writes. First, user credentials, virtualized through UID
namespaces, isolate the root user in one VP from the root user in the root
namespace or any other VP. Second, kernel-level device namespaces isolate
device access and associated data; no data or device state may be accessed
outside a VP&#x2019;s device namespace. Third, mount namespaces provide a unique and
separate FS view for each VP; no files belonging to one VP may be accessed by
another VP. Fourth, CellD removes the capability to create device nodes
inside a VP, preventing processes from gaining direct access to Linux devices
or outside their environment, e.g., by re-mounting block devices. These
isolation techniques secure Cells system data from each VP, and individual VP
data from other VPs.</p>
</div>
</blockquote>
</div>

</div>
<div class="slide" id="_device_virtualization">
<h2>Device Virtualization</h2>

<div class="paragraph">
<p>3/4 of these problem had already been solved by existing container
virtualization approaches.</p>
</div>
<div class="ulist">
<div class="title slide">What&#x2019;s hard on smartphones?</div>
<ul>
<li class="slide">
<p>Device virtualization.</p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
<div class="quoteblock small">
<blockquote>
<div class="paragraph">
<p>Cells meets all three requirements in the tightly integrated, and often
proprietary, smartphone ecosystem. It does so by integrating novel
kernel-level and user-level device virtualization methods to present a
complete virtual smartphone OS environment. Kernel-level mechanisms provide
transparency and performance. User-level mechanisms provide portability and
transparency when the user space environment provides interfaces that can be
leveraged for virtualization. <strong>For proprietary devices with completely closed
software stacks, user-level virtualization is necessary.</strong></p>
</div>
</blockquote>
</div>

</div>
<div class="slide" id="_user_and_kernel_level_virtualization">
<h2>User- and Kernel-Level Virtualization</h2>

<div class="ulist">
<div class="title slide">What does it mean to have to do both?</div>
<ul>
<li class="slide">
<p>I have to make changes to the OS kernel. (Duh.)</p>
</li>
<li class="slide">
<p>I also have to make changes to the user-space processes, in this case the
<em>Android runtime</em>.</p>
</li>
</ul>
</div>
<div style="page-break-after: always;"></div>
<div class="quoteblock small">
<blockquote>
<div class="paragraph">
<p>The entire radio baseband system is proprietary and closed source, starting
from the user-level RIL vendor library down to the physically separate
hardware baseband processor. Details of the vendor library implementation and
its communication with the baseband are well-guarded secrets. Each hardware
phone vendor provides its own proprietary radio stack. Since the stack is a
complete black box, it would be difficult if not impossible to intercept,
replicate, or virtualize any aspect of this system in the kernel without
direct hardware vendor support. Furthermore, the vendor library is designed
to be used by only a single RilD and the radio stack as a whole is not
designed to be multiplexed.</p>
</div>
</blockquote>
</div>
<div style="page-break-after: always;"></div>
<div class="paragraph">
<p><span class="image"><img src="/img/slides/figures/cells-ril.jpg" alt="cells ril" style="width: 60%;"></span></p>
</div>

</div>
<div class="slide" id="_multiple_phone_numbers">
<h2>Multiple Phone Numbers</h2>

<div class="quoteblock small">
<blockquote>
<div class="paragraph">
<p>While some smartphones support multiple SIM cards, which makes supporting
multiple phone numbers straightforward, most phones do not provide this
feature. Since mobile network operators do not generally o&#x21B5;er multiple phone
numbers per SIM card or CDMA phone, we o&#x21B5;er an alternative system to provide
a distinct phone number for each VP on existing unmodified single SIM card
phones, which dominate the market. Our approach is based on pairing Cells
with a VoIP service that enables telephony with the standard cellular voice
network and standard Android applications, but with separate phone numbers.</p>
</div>
</blockquote>
</div>

</div>
<div class="slide" id="_to_the_paper">
<h2>To The Paper</h2>

<div class="responsive-embed embed-responsive-4by3" style="height:440px;">
<iframe style="width:100%" height="400" class="embed-responsive-item" src="//systems.cs.columbia.edu/files/wpid-cells-sosp2011.pdf" id="_iframe_2"></iframe>
<div class="anim-play slide" data-what="iframe#_iframe_2"></div><div class="anim-pause slide" data-what="iframe#_iframe_2"></div></div>

</div>
<div class="nooutline slide" id="_next_time">
<h2>Next Time</h2>

<div class="ulist">
<ul>
<li>
<p>Exam review</p>
</li>
</ul>
</div>

</div>

				<div data-progress-size=": spe.bottom(3, 24) ; left: slide.left+&apos;px&apos; ; height: (4*designRatio)+&apos;px&apos;" data-progress="width: pFull * slide.width" style="background: #191995; position: absolute; z-index:-1"></div>
				<div class="deck-status deck-progress-10"></div>
				<div class="deck-status-wrapper" data-progress-size=": spe.bottom(16, 20);left:(slide.left+10)+&apos;px&apos;;height:(30*designRatio)+&apos;px&apos;" style="padding-top:2px; position: absolute; display:none; z-index:10">
					<span style="margin-right:20px;"><a target="_blank" href="/slides/">Home</a></span>
					<span style="margin-right:20px;"><a target="_blank" href="/slides/2016-05-02-cells">Outline</a></span>
					<span style="margin-right:20px;">
						(<span class="deck-status-current"></span> / <span class="deck-status-total"></span>)
					</span>
				</div>
				<div>
					<a class="deck-prev-link" href="#" title="Previous">&#x2190;</a>
					<a class="deck-next-link" href="#" title="Next">&#x2192;</a>
				</div>
			</div>
		</div>
	

</body></html>